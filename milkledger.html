<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Milk Record Tracker</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; max-width: 600px; margin: auto; }
  h1 { text-align: center; }
  table { width: 100%; border-collapse: collapse; margin-top: 20px; }
  th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
  input { width: 80px; }
  button { margin-top: 10px; padding: 10px; width: 100%; }
  #clearBtn { background-color: #f44336; color: white; margin-top: 10px; }
  .deleteBtn { background-color: #e53935; color: white; padding: 4px 8px; border: none; cursor: pointer; }
</style>
</head>
<body>

<h1>Milk Record Tracker</h1>

<label>Date: <input type="date" id="date"></label><br><br>
<label>Liters: <input type="number" id="liters" min="0" step="0.1"></label><br><br>
<label>Price per Liter: <input type="number" id="price" min="0" step="0.1"></label><br><br>

<button onclick="addRecord()">Add Record</button>
<button id="clearBtn" onclick="clearHistory()">Clear History</button>

<h2>Monthly Records</h2>
<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Liters</th>
      <th>Price/Liter</th>
      <th>Total Amount</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody id="recordTable"></tbody>
  <tfoot>
    <tr>
      <td colspan="3"><strong>Monthly Total</strong></td>
      <td id="monthlyTotal">0</td>
      <td></td>
    </tr>
  </tfoot>
</table>

<script>
  function getTodayDate() {
    const d = new Date();
    return d.toISOString().split('T')[0];
  }

  // Load saved records from localStorage, start empty if none
  let records = JSON.parse(localStorage.getItem('milkRecords')) || [];

  // Auto-fill date input with today
  document.getElementById('date').value = getTodayDate();

  function updateTable() {
    const table = document.getElementById('recordTable');
    table.innerHTML = '';
    let total = 0;

    records.forEach((r, index) => {
      const row = document.createElement('tr');
      const dailyTotal = r.liters * r.price;
      row.innerHTML = `
        <td>${r.date}</td>
        <td>${r.liters}</td>
        <td>${r.price}</td>
        <td>${dailyTotal.toFixed(2)}</td>
        <td><button class="deleteBtn" onclick="deleteRecord(${index})">Delete</button></td>
      `;
      table.appendChild(row);
      total += dailyTotal;
    });

    document.getElementById('monthlyTotal').innerText = total.toFixed(2);
  }

  function addRecord() {
    const date = document.getElementById('date').value;
    const liters = parseFloat(document.getElementById('liters').value);
    const price = parseFloat(document.getElementById('price').value);

    if (!date || isNaN(liters) || isNaN(price)) {
      alert('Please fill all fields!');
      return;
    }

    const existingIndex = records.findIndex(r => r.date === date);
    if (existingIndex >= 0) {
      records[existingIndex] = { date, liters, price };
    } else {
      records.push({ date, liters, price });
    }

    localStorage.setItem('milkRecords', JSON.stringify(records));
    updateTable();

    document.getElementById('liters').value = '';
    document.getElementById('price').value = '';
    document.getElementById('date').value = getTodayDate();
  }

  function deleteRecord(index) {
    if (confirm('Delete this record?')) {
      records.splice(index, 1);
      localStorage.setItem('milkRecords', JSON.stringify(records));
      updateTable();
    }
  }

  function clearHistory() {
    if (confirm('Are you sure you want to clear all records?')) {
      records = [];
      localStorage.removeItem('milkRecords');
      updateTable();
    }
  }

  updateTable(); // initial load
</script>

</body>
</html>
